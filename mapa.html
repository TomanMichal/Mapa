<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <title>Mapa v√Ωlet≈Ø - Google Sheets</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        /* V√Ωchoz√≠ velikost mapy */
        #mapa {
            width: 100%;
            height: 600px;
            transition: all 0.5s ease;
        }

        /* Tlaƒç√≠tko pro zvƒõt≈°en√≠/zmen≈°en√≠ mapy */
        #resize-button {
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            background: #0078D7;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        /* Kontejner pro tlaƒç√≠tko */
        .map-container {
            text-align: center;
            margin-bottom: 10px;
        }
    </style>
</head>

<body>

    <h1>Mapa v√Ωlet≈Ø</h1>

    <!-- Odkaz na Google Formul√°≈ô -->
    <p><a href="https://docs.google.com/forms/d/e/1FAIpQLSeAXrG46eK_EQYM9s-sIp99Bf7B_vDC2s3Sl9DtV3HWrBD3Ow/viewform?usp=dialog">‚ûï P≈ôidat nov√© m√≠sto</a></p>

    <div class="map-container">
        <!-- Tlaƒç√≠tko pro zvƒõt≈°en√≠/zmen≈°en√≠ mapy -->
        <button id="resize-button" onclick="toggleSize()">üîç Zvƒõt≈°it mapu</button>
    </div>

    <!-- Mapa -->
    <div id="mapa"></div>

    <!-- Leaflet JS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // Inicializace mapy (st≈ôed: ƒåR)
        var mapa = L.map('mapa').setView([50.087, 14.421], 7);

        // Naƒçten√≠ OpenStreetMap dla≈ædic
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(mapa);

        // Ikona fotoapar√°tu
        var cameraIcon = L.icon({
            iconUrl: 'https://cdn-icons-png.flaticon.com/512/685/685655.png',
            iconSize: [32, 32],
            iconAnchor: [16, 32],
            popupAnchor: [0, -32]
        });

        // Naƒçten√≠ dat z Google Sheets
        const sheetId = '1YgtoCBTJicz1NRdksY67vdVmT2xze33iHDcCE1C0GCI';
        const sheetUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;

        fetch(sheetUrl)
            .then(response => response.text())
            .then(data => {
                // Parsov√°n√≠ JSON dat z Google Sheets
                const jsonData = JSON.parse(data.substring(47, data.length - 2));
                const rows = jsonData.table.rows;

                rows.forEach(row => {
                    const nazev = row.c[1].v;  // N√°zev
                    const lat = parseFloat(row.c[2].v);  // ≈†√≠≈ôka
                    const lng = parseFloat(row.c[3].v);  // D√©lka
                    const url = row.c[4].v;  // URL fotek
                    const kategorie = row.c[5].v;  // Kategorie

                    // P≈ôid√°n√≠ markeru na mapu
                    L.marker([lat, lng], { icon: cameraIcon })
                        .bindPopup(`<b>${nazev}</b><br><a href="${url}" target="_blank">Fotky z v√Ωletu</a><br>Kategorie: ${kategorie}`)
                        .addTo(mapa);
                });
            })
            .catch(error => console.error('Chyba p≈ôi naƒç√≠t√°n√≠ dat:', error));

        // Funkce pro zvƒõt≈°en√≠/zmen≈°en√≠ mapy
        function toggleSize() {
            const mapaDiv = document.getElementById('mapa');
            const button = document.getElementById('resize-button');

            if (mapaDiv.style.height === '90vh') {
                mapaDiv.style.height = '600px';
                button.innerHTML = 'üîç Zvƒõt≈°it mapu';
            } else {
                mapaDiv.style.height = '90vh';
                button.innerHTML = 'üîô Zmen≈°it mapu';
            }

            // Oprava vykreslen√≠ mapy po zmƒõnƒõ velikosti
            setTimeout(() => mapa.invalidateSize(), 500);
        }
    </script>

</body>

</html>